<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Minimal example</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Minimal example</h1>



<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<div id="installation" class="section level3">
<h3>Installation</h3>
<p>Install the release version from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;spectre&quot;)</span></span></code></pre></div>
<p>To install the developmental version of <code>spectre</code>, use:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;r-spatialecology/spectre&quot;) #Uncomment when repo is public</span></span></code></pre></div>
</div>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>Before we illustrate how the <em>objective matrix</em> is derived from modelled <span class="math inline">\(\alpha\)</span>-diversity and Bray-Curtis dissimilarity, we do a detour first. If you already have modelled <span class="math inline">\(\alpha\)</span>- and Bray-Curtis dissimilarity estimates at hand, please skip ahead. In the detour, we just use a random species composition to i) get an <span class="math inline">\(\alpha\)</span>- diversity estimate and to ii) generate a Bray-Curtis dissimilarity estimate in the output format of the <code>gdm</code> package (Fitzpatrick et al., 2020).</p>
<div id="get-alpha-diversity-and-bray-curtis-dissimilarity-from-a-random-species-composition-detour" class="section level3">
<h3>Get <span class="math inline">\(\alpha\)</span>-diversity and Bray-Curtis dissimilarity from a random species composition (detour)</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;gdm&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create random species composition</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>nspecies <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>nsites <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>presence_prob <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="co"># probability for each species to be present at each site</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>get_species_list <span class="ot">&lt;-</span> <span class="cf">function</span>(nspecies, nsites, presence_prob)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate a siteXspecies list with a random set of species presences/absences</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill list with random species presences</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> nspecies, <span class="at">ncol =</span> nsites, <span class="at">data =</span> <span class="dv">0</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(m)) {</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(m)) {</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> presence_prob) {</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        m[col, row] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode</span>(m) <span class="ot">&lt;-</span> <span class="st">&quot;integer&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(m)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># random species composition</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>species_list <span class="ot">&lt;-</span> <span class="fu">get_species_list</span>(<span class="at">nspecies =</span> nspecies, <span class="at">nsites =</span> nsites, </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">presence_prob =</span> presence_prob) </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co"># calculation of Bray-Curtis dissimilarity with the gdm package: </span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># bioData is required by the gdm package, but does not affect </span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># the observed Bray-Curtis dissimilarity we will use later</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>bioData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">site_id =</span> <span class="dv">1</span><span class="sc">:</span>nsites, <span class="at">x_coords =</span> <span class="fu">rep</span>(<span class="dv">13</span>, nsites), </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y_coords =</span> <span class="fu">rep</span>(<span class="dv">10</span>, nsites)) </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>bioData <span class="ot">&lt;-</span> <span class="fu">cbind</span>(bioData, <span class="fu">t</span>(species_list)) </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>predData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">site_id =</span> <span class="dv">1</span><span class="sc">:</span>nsites, <span class="at">preds =</span> <span class="fu">runif</span>(nsites))</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>sitepairs <span class="ot">&lt;-</span> gdm<span class="sc">::</span><span class="fu">formatsitepair</span>(<span class="at">bioData =</span> bioData, <span class="at">bioFormat =</span> <span class="dv">1</span>, <span class="at">abundance =</span> <span class="cn">FALSE</span>, </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">siteColumn =</span> <span class="st">&quot;site_id&quot;</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">XColumn =</span> <span class="st">&quot;x_coords&quot;</span>, <span class="at">YColumn =</span> <span class="st">&quot;y_coords&quot;</span>, </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">predData =</span> predData)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>gdm_result <span class="ot">&lt;-</span> gdm<span class="sc">::</span><span class="fu">gdm</span>(sitepairs, <span class="at">geo =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
</div>
<div id="solve-species-composition-using-spectre" class="section level3">
<h3>Solve species composition using <code>spectre</code></h3>
<p>Running the optimization is straightforward in <code>spectre</code> and only includes one function call. However, first we need to generate to commonness matrix from the <code>gdm</code> predictions to generate the object matrix. Then, we simply run the optimization using the alpha list, the <span class="math inline">\(gamma\)</span>-diversity, the objective matrix (or target), and finally the number of maximum iterations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;spectre&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate objective_matrix from (modelled) alpha-diversity and Bray-Curtis dissimilarity</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>alpha_list <span class="ot">&lt;-</span> <span class="fu">colSums</span>(species_list) <span class="co"># alpha-diversity of random species community</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>objective_matrix <span class="ot">&lt;-</span> spectre<span class="sc">::</span><span class="fu">generate_commonness_matrix_from_gdm</span>(<span class="at">gdm_predictions =</span> gdm_result<span class="sc">$</span>observed, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="at">alpha_list =</span> alpha_list)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve composition </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> spectre<span class="sc">::</span><span class="fu">run_optimization_min_conf</span>(<span class="at">alpha_list =</span> alpha_list,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">total_gamma =</span> nspecies,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">target =</span> objective_matrix,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">max_iterations =</span> <span class="dv">1000</span>) <span class="co"># n iterations</span></span></code></pre></div>
<pre><code>## 
##  &gt; Optimization finished with lowest absolute error = 5 (highest absolute error was: 101 improved by: 96)</code></pre>
</div>
<div id="result-evaluation" class="section level3">
<h3>Result evaluation</h3>
<p><code>spectre</code> allows to easily calculate some error measures, namely the mean absolute commonness error (<span class="math inline">\(MAE_c\)</span>) and the relative commonness error [%] (RCE). The error is calculated between the solved species composition and the objective matrix.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>error_c <span class="ot">&lt;-</span> spectre<span class="sc">::</span><span class="fu">calc_commonness_error</span>(<span class="at">x =</span> res, <span class="at">objective_matrix =</span> objective_matrix)</span></code></pre></div>
<p>The <em>objective matrix</em> had a mean commonness of 1.75. The mean absolute error between the <em>objective matrix</em> and the solved <em>solution matrix</em> was 0.05. The solution matrix had an relative commonness error (RCE) of 2.7%.</p>
<p>There are also two functions to visualize the optimization. First you can plot the error of the solution matrix over time. Second, you can plot the commonness error between the solution matrix and the objective matrix.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With an increasing number of iterations, the solution matrix improved</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>spectre<span class="sc">::</span><span class="fu">plot_error</span>(<span class="at">x =</span> res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="50%" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot commonness error between objective matrix and solution matrix</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>spectre<span class="sc">::</span><span class="fu">plot_commonness</span>(<span class="at">x =</span> res, <span class="at">target =</span> objective_matrix)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="50%" /></p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Matthew C. Fitzpatrick, Karel Mokany, Glenn Manion, Matthew Lisk, Simon Ferrier and Diego Nieto-Lugilde (2021). gdm: Generalized Dissimilarity Modeling. R package version 1.4.2.2. <a href="https://CRAN.R-project.org/package=gdm" class="uri">https://CRAN.R-project.org/package=gdm</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
